({15797:function(){var e=this&&this.__awaiter||function(e,t,a,l){return new(a||(a=Promise))((function(n,r){function o(e){try{s(l.next(e))}catch(e){r(e)}}function i(e){try{s(l.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,i)}s((l=l.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var a,l,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(i){return function(s){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,i[0]&&(o=0)),o;)try{if(a=1,l&&(n=2&i[0]?l.return:i[0]?l.throw||((n=l.return)&&n.call(l),0):l.next)&&!(n=n.call(l,i[1])).done)return n;switch(l=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,l=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((n=(n=o.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],l=0}finally{a=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function a(){return e(this,void 0,void 0,(function(){var a=this;return t(this,(function(l){switch(l.label){case 0:return[4,Excel.run((function(l){return e(a,void 0,void 0,(function(){return t(this,(function(e){switch(e.label){case 0:return l.workbook.getActiveCell().valuesAsJson=[[v()]],[4,y(l.sync)];case 1:return e.sent(),n(),[2]}}))}))}))];case 1:return l.sent(),[2]}}))}))}function l(){return e(this,void 0,void 0,(function(){var a=this;return t(this,(function(l){switch(l.label){case 0:return[4,Excel.run((function(l){return e(a,void 0,void 0,(function(){var e,a,r;return t(this,(function(t){switch(t.label){case 0:return(e=l.workbook.getActiveCell()).load("valuesAsJson"),[4,l.sync()];case 1:switch(t.sent(),a=e.valuesAsJson[0][0],n(),r="LinkedEntity"==a.type?"Entity":a.type,$("#dataTypeSelect").val(r),b(u(r)),a.type){case"String":case"Double":$("#basicValue").val(a.basicValue);break;case"Boolean":a.basicValue?$("#basicValue").val("true"):$("#basicValue").val("false");break;case"WebImage":$("#url").val(a.address),$("#altText").val(a.altText);break;case"FormattedNumber":$("#format").val(a.numberFormat),$("#number").val(a.basicValue);break;case"Entity":case"LinkedEntity":!function(e){var t;null!=e.layouts&&null!=e.layouts.card&&(t=e.layouts.card.sections),null==t&&(t=[{layout:"List",properties:Object.keys(e.properties)}]),null!=e.referencedValues?($("#referencedValues").val(JSON.stringify(e.referencedValues)),$("#referencedValuesDiv")[0].style.display="block"):$("#clearReferencedValue")[0].onclick(null),null!=e.provider&&(null!=e.provider.description&&$("#providerDescription").val(e.provider.description),null!=e.provider.description&&$("#providerTarget").val(e.provider.logoTargetAddress),null!=e.provider.description&&$("#providerLogo").val(e.provider.logoSourceAddress));for(var a=[],l=0;l<t.length;++l){$(".sectionTitle").last().val(t[l].title);var n=t[l].properties;$(".specificFieldContents").last().remove();for(var r=0;r<n.length;++r){$(".fields").last().append(p());var o=n[r];a.push(o);var i=e.properties[o],s=$(".dataTypeSelectEntity").last().parent().parent().parent().parent().next().children();switch(i.type){case"Double":$(".dataTypeSelectEntity").last().val("Double"),s.replaceWith(d(i.type).children());break;case"Boolean":$(".dataTypeSelectEntity").last().val("Boolean"),s.replaceWith(d(i.type).children());break;case"FormattedNumber":$(".dataTypeSelectEntity").last().val("FormattedNumber"),s.replaceWith(d(i.type).children());break;case"WebImage":$(".dataTypeSelectEntity").last().val("WebImage"),s.replaceWith(d(i.type).children()),$(".cardView").last().parent().before('<div class="checkboxes">\n                  <input type="checkbox" class="mainImage" alt="main image checkbox"/>\n                  <label>Make main image</label>\n                </div><br>');break;case"String":$(".dataTypeSelectEntity").last().val("String"),s.replaceWith(d(i.type).children());break;default:$(".dataTypeSelectEntity").last().val("Unsupported"),s.replaceWith(d("Unsupported").children())}}}$("#displayString").val(e.text),null==e.layouts||null==e.layouts.compact?$("#iconSelect").val("Generic"):null!=e.layouts.compact.icon&&$("#iconSelect").val(e.layouts.compact.icon);var c=$(".fieldName"),u=$(".cardView"),b=$(".autoComplete"),v=$(".calcCompare"),f=$(".dotNotation"),y=$(".sublabel"),m=$(".basicValue"),g=$(".url"),h=$(".number"),x=$(".format"),V=$(".altText"),k=$(".mainImage"),C=$(".unsupportedValue");for(l=0;l<a.length;++l){switch(o=a[l],i=e.properties[o],c.first().val(o),i.type){case"Double":case"Boolean":case"String":m.first().val(i.basicValue),m=m.slice(1);break;case"WebImage":g.first().val(i.address),V.first().val(i.altText),g=g.slice(1),V=V.slice(1),null!=e.layouts&&null!=e.layouts.card.mainImage&&e.layouts.card.mainImage.property==o&&k.first().prop("checked",!0);break;case"FormattedNumber":h.first().val(i.basicValue),x.first().val(i.numberFormat),h=h.slice(1),x=x.slice(1);break;default:C.first().val(JSON.stringify(i)),C=C.slice(1)}var S={cardView:!1,autoComplete:!1,calcCompare:!1,dotNotation:!1},T="";"object"==typeof i.propertyMetadata&&("object"==typeof i.propertyMetadata.excludeFrom&&(S=Object.assign(S,i.propertyMetadata.excludeFrom)),"string"==typeof i.propertyMetadata.sublabel&&(T=i.propertyMetadata.sublabel)),u.first().prop("checked",!S.cardView),b.first().prop("checked",!S.autoComplete),v.first().prop("checked",!S.calcCompare),f.first().prop("checked",!S.dotNotation),y.first().val(T),c=c.slice(1),u=u.slice(1),b=b.slice(1),v=v.slice(1),f=f.slice(1),y=y.slice(1)}}(a)}return[2]}}))}))}))];case 1:return l.sent(),[2]}}))}))}function n(){return e(this,void 0,void 0,(function(){return t(this,(function(e){return $(".inputBox").val(""),$(".cardView").prop("checked",!0),$(".autoComplete").prop("checked",!0),$(".calcCompare").prop("checked",!0),$(".dotNotation").prop("checked",!0),$(".mainImage").prop("checked",!1),$(".sublabel").val(""),$(".specificFieldContents").remove(),$(".sectionContents").remove(),$("#iconSelect").val("Generic"),b(u($("#dataTypeSelect").val().toString())),[2]}))}))}Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("setData").onclick=a,document.getElementById("getData").onclick=l,document.getElementById("clearForm").onclick=n,$("#dataTypeSelect").on("change",(function(){b(u($("#dataTypeSelect option:selected").val().toString()))})),b(u(r)))}));var r="FormattedNumber";function o(e,t,a){return[$("<td>").append($("<label/>",{for:e,class:"labels"}).text(t)),$("<td>").append($("<input/>",{class:"inputBox "+e,type:"text",id:e,alt:a}))]}function i(e,t,a){return $("<div/>",{class:"checkboxes"}).append($("<input/>",{type:"checkbox",class:e,checked:!0,alt:a})).append($("<label/>").text(t))}function s(e){return $("<tr/>",{id:e,class:"fieldValueContents"}).append(o("basicValue","Value: ","value input box"))}function c(e){var t=[];return e.forEach((function(e){var a=e.replace(" ","");t.push($("<option/>",{class:"type"+a,value:a}).text(e))})),t}function p(){var e=d("String"),t=$("<label><strong>Data type: </strong></label>"),a=$("<select/>",{id:"dataTypeSelectEntity",name:"dataType",class:"dataTypeSelectEntity ms-Button ms-Button-label buttons"});a[0].onchange=function(){var t=a[0].options,l=t.item(t.selectedIndex).value;$(e).children().replaceWith(d(l).children())};for(var l=c(["String","Double","Boolean","Web Image","Formatted Number"]),n=0;n<l.length;++n)a.append(l[n]);a.append($("<option/>",{class:"typeUnsupported",value:"Unsupported",disabled:!0}).text("Unsupported"));var r=$("<table/>",{id:"fieldTable"}).append($("<tbody/>").append($("<tr/>").append($("<td/>").append(t).append(a))));return $("<div/>",{id:"specificField",class:"specificFieldContents formContents solidBorder"}).append(r).append(e)}function u(e){switch(e){case"String":return s("String");case"Double":return s("Double");case"Boolean":return s("Boolean");case"FormattedNumber":return[$("<tr/>",{id:"FormattedNumber",class:"fieldValueContents"}).append(o("number","Number: ","Number input box")),$("<tr/>").append(o("format","Format: ","Format input box"))];case"WebImage":return[$("<tr/>",{id:"WebImage",class:"fieldValueContents"}).append(o("url","Image url: ","Image url input box")),$("<tr/>").append(o("altText","[Recommended] Alt-text: ","Alt-text input box"))];case"Entity":return function(){for(var e=$('<div class="contentPadding"/>'),t=$('<label class="labels"> Entity icon: </label>'),a=$('<label class="labels contentPadding">Entity contents:</label>'),l=$('<select id="iconSelect" name="dataType" class="ms-Button ms-Button-label buttons"/>'),n=c(Object.values(Excel.EntityCompactLayoutIcons)),r=0;r<n.length;++r)l.append(n[r]);e.append(t),e.append(l);var i=$('<div class="sections"/>').append(function(){var e,t,a,l=$('<div id="defaultSection" class="sectionContents formContents solidBorder"/>'),n=$("<label/>",{class:"sectionHeader"}).text("Default section: ");return l.append([n,(e=$('<div class="fields"/>').append(p()),t=$('<div class="collapsibleSection" aria-expanded="true"/>').append(e),a=$("<button/>",{id:"addField",class:"ms-Button ms-Button-label buttons",alt:"add another field to current section",style:"margin-left:20px;"}).text("Add another field"),a[0].onclick=function(){$(e).append(p())},t.append(a),t)]),l}()),s=$('<label for="displayString" class="labels">Entity display text: </label>'),u=$('<input class="inputBox displayString" type="text" id="displayString" alt="display text input box"/>'),d=$('<div id="entityContents" class="solidBorder formContents"/>').append($('<table id="fieldTable"/>').append($("<tbody/>").append($("<tr/>").append(o("providerDescription","Description: ","Provider description input box"))).append($("<tr/>").append(o("providerTarget","Provider address: ","Provider source input box"))).append($("<tr/>").append(o("providerLogo","Logo address: ","Provider logo input box"))))),b=$('<label for="referencedValues" class="labels">Referenced values: </label>'),v=$('<input class="inputBox displayString" type="text" id="referencedValues" alt="referencedValues text display box" disabled/>'),f=$("<button/>",{id:"clearReferencedValue",class:"ms-Button ms-Button-label buttons",text:"Clear referencedValues"}),y=$("<div/>",{id:"referencedValuesDiv"}).append(b).append(v).append(f);y[0].style.display="none",f[0].onclick=function(){v.val(""),y[0].style.display="none"};var m=$("<div/>",{class:"contentPadding"}).append($("<label/>",{class:"labels"}).text("Provider info: ")).append(d);return $('<tr id="Entity"/>').append($('<td colspan="2"/>').append([s,u]).append(e).append(m).append(y).append(a).append(i))}();default:return $("<tr/>",{id:"Unsupported",class:"fieldValueContents"}).append($("<td/>").append($("<label/>",{for:"unsupportedValue",class:"labels"}).text("unsupportedValue: "))).append($("<td/>").append($("<input>",{class:"inputBox unsupportedValue",disabled:!0,type:"text",name:"unsupportedValue",id:"unsupportedValue",alt:"unsupportedValue input box"})))}}function d(e){var t=$('<tr>\n          <td><label class="labels">Key:</label></td>\n          <td><input class="inputBox fieldName" alt="Key input box"/></td>\n        </tr>'),a=$('<td colspan="4" class="center settings"/>');"WebImage"==e&&(a.append(i("mainImage","Make main image","main image checkbox")),a.append($("<br/>"))),a.append([i("cardView","Card View","cardview checkbox"),i("autoComplete","Autocomplete","autoComplete checkbox"),$("<br/>"),i("calcCompare","Calc compare","calcCompare checkbox"),i("dotNotation","Dot notation","dotNotation checkbox"),$("<br/>"),$("<label/>").text("Sublabel: "),$("<input/>",{class:"sublabel",alt:"sublabel input box"})]);var l=$('<tr class="metadata" style="visibility:collapse"/>').append(a),n=$("<tr/>"),r=$('<td colspan="4"/>'),o=$('<button class="ms-Button ms-Button-label buttons" alt="Toggle to expand or collapse metadata properties of field">More settings</button>');return o[0].onclick=function(){var e=l[0].style.visibility;l[0].style.visibility="collapse"!=e?"collapse":"visible"},r.append([o]),n.append(r),$('<div id="entityContents"/>').append($('<table id="fieldTable"/>').append($("<tbody/>").append(t).append(u(e)).append([l,n])))}function b(e){var t=$('<div class= "backgroundColorForm solidBorder"/>');t.append(e),$(".backgroundColorForm").replaceWith(t)}function v(){switch($("#dataTypeSelect option:selected").val()){case"String":var e=$("#basicValue").val().toString();return{type:Excel.CellValueType.string,basicValue:e};case"Double":var t=Number($("#basicValue").val());if(!isNaN(t))return{type:Excel.CellValueType.double,basicValue:t};alert("Type 'Double' selected but input was not a double.");break;case"Boolean":var a=$("#basicValue").val().toString();if("true"===a.toLowerCase())return{type:Excel.CellValueType.boolean,basicValue:!0};if("false"===a.toLowerCase())return{type:Excel.CellValueType.boolean,basicValue:!1};alert("Type 'Boolean' selected but input was not a boolean.");break;case"Entity":return function(){for(var e,t=$("#displayString").val().toString(),a=$("#iconSelect option:selected").val(),l=$("#referencedValues").val(),n=f(".fieldName"),r=function(){for(var e=$(".fieldValueContents"),t=$(".basicValue"),a=$(".url"),l=$(".number"),n=$(".format"),r=$(".altText"),o=$(".unsupportedValue"),i=[];e.length>0;){var s=void 0;switch(e.first().attr("id")){case"String":s={type:Excel.CellValueType.string,basicValue:t.first().val().toString()},t=t.slice(1);break;case"FormattedNumber":var c=Number(l.first().val());isNaN(c)?alert("Type 'FormattedNumber' selected but input was not a number."):s={type:Excel.CellValueType.formattedNumber,basicValue:c,numberFormat:n.first().val().toString()},l=l.slice(1),n=n.slice(1);break;case"Double":c=Number(t.first().val()),isNaN(c)?alert("Type 'Double' selected but input was not a double."):s={type:Excel.CellValueType.double,basicValue:c},t=t.slice(1);break;case"Boolean":var p=t.first().val().toString();"true"===p.toLowerCase()?s={type:Excel.CellValueType.boolean,basicValue:!0}:"false"===p.toLowerCase()?s={type:Excel.CellValueType.boolean,basicValue:!1}:alert("Type 'Boolean' selected but input was not a boolean."),t=t.slice(1);break;case"WebImage":s={type:Excel.CellValueType.webImage,address:a.first().val(),altText:r.first().val()},a=a.slice(1),r=r.slice(1);break;case"Unsupported":s=JSON.parse(o.first().val().toString()),o=o.slice(1)}i.push(s),e=e.slice(1)}return i}(),o=f(".cardView"),i=f(".autoComplete"),s=f(".calcCompare"),c=f(".dotNotation"),p=f(".sublabel"),u=f(".mainImage"),d=[f("#providerDescription"),f("#providerTarget"),f("#providerLogo")],b=!1,v=[],y=$(".sectionContents"),m=!0;y.length>0;){for(var g=y.first(),h=g.find(".fieldName"),x=g.find(".sectionTitle"),V=[],k=0;k<h.length;++k){var C=$(h[k]).val();V.push(C)}if(m)m=!1,y=y.slice(1);else{var S={layout:"List",title:x.val(),properties:V};v.push(S),y=y.slice(1)}}var T={type:Excel.CellValueType.entity,text:t,properties:{},layouts:{card:{},compact:{}}};for(""==d[0][0]&&""==d[1][0]&&""==d[2][0]||(T.provider={description:d[0][0],logoTargetAddress:d[1][0],logoSourceAddress:d[2][0]}),k=0;k<n.length;++k){var w=n[k],N=r[k];if(""==w||""==N)break;var E={};o[k]||(E.cardView=!0),i[k]||(E.autoComplete=!0),s[k]||(E.calcCompare=!0),c[k]||(E.dotNotation=!0);var B={};Object.keys(E).length>0&&(B.excludeFrom=E),""!=p[k]&&(B.sublabel=p[k]),"WebImage"==N.type&&(u[0]&&!b&&(e=w,b=!0),u=u.slice(1)),Object.keys(B).length>0&&(N.propertyMetadata=B),T.properties[w]=N}return T.layouts.card=b?{mainImage:{property:e},sections:v}:{sections:v},""!=l&&(T.referencedValues=JSON.parse(l)),"Generic"!=a&&(T.layouts.compact.icon=a),T}();case"WebImage":var l=$("#url").val().toString(),n=$("#altText").val().toString();return{type:Excel.CellValueType.webImage,address:l,altText:n};case"FormattedNumber":t=Number($("#number").val());var r=$("#format").val();if(!isNaN(t))return{type:Excel.CellValueType.formattedNumber,basicValue:t,numberFormat:r};alert("Type 'FormattedNumber' selected but input was not a number.")}}function f(e){for(var t=$(e),a=[];t.length>0;){var l=t.first();l.is("input[type=checkbox]")?a.push(l.prop("checked")):a.push(l.val()),t=t.slice(1)}return a}function y(a){return e(this,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,a()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),alert("Error in running script:\n\n"+e+"."),console.error(e),[3,3];case 3:return[2]}}))}))}}})[15797]();
//# sourceMappingURL=taskpane.js.map